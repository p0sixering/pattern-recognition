<!DOCTYPE html>
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<!-- Synth scripts from Stuart Memo:  http://stuartmemo.com/synth/ -->
<script src="synth/tsw.js"></script>
<script src="synth/synth.js"></script>

<script type="text/javascript" src="raphael-min.js"></script>
<script type="text/javascript" src="shapes.js"></script>
<script type="text/javascript" src="buttons.js"></script>
<script type="text/javascript" src="layouts.js"></script>
<script type="text/javascript" src="mod-functions.js"></script>
</head>

<body>
<script type="text/javascript">

// From http://stackoverflow.com/questions/321113/
function partial(func /*, 0..n args */) {
  var args = Array.prototype.slice.call(arguments, 1);
  return function() {
    var allArguments = args.concat(Array.prototype.slice.call(arguments));
    return func.apply(this, allArguments);
  };
}

// mouse on / off functions:
function betterNoteClick(synth, note) {
    synth.playNote(note);
}

function betterNoteStop(synth, note) {
    synth.stopNote(note);
}

// Global button data
var buttonData = [];
var butttonDifferences = {};



function init() {
    // Creates canvas.
    var screensize = {x: 1024, y:  768}
    var paper = Raphael(0, 0, screensize.x, screensize.y);

    // Hyper-rough faux mapping
    for (var i = 0; i < buttonData.length; i++) {
        // Create the synth for each button:  this may run me out of processor.
        var synth = new Synth({
            context: tsw.context(),
            speakersOn: true
        });

        // Yes, we can change parameters per synth here
        var freq = buttonData[i].location.x * 2.1828 + buttonData[i].location.y / 1.618;
        
        var pitchString = 'C4';
        if (i % 2 == 0) {
            pitchString = 'D3';
        }

        var mouseDownFunc = partial(betterNoteClick, synth, pitchString);
        var mouseUpFunc = partial(betterNoteStop, synth, pitchString);
        buttonData[i].button.node.addEventListener('mousedown', mouseDownFunc);
        buttonData[i].button.node.addEventListener('mouseup', mouseUpFunc);
    }
}

window.onload = init;
</script>
</body>
</html>