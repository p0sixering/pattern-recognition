<!DOCTYPE html>
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<script type="text/javascript" src="raphael-min.js"></script>
</head>

<body>
<script type="text/javascript">

// How does this deal with rectangles?!?!
buttonData = {color: '#000000', // hex string
              brightness:  0.0, // float, extracted from color.  Mean of RGB
              radius:  10, // int
              area: 34.0, // float, may not need this
              size: 'small', // string enumeration of tiny, small, medium, large, huge
              center:  {x: 5, y: 5}, // point object of ints
              rotation: Math.PI / 4, // float, in radians
              shape:  'hexagon', // string enumeration
              sides: 6, // int
    };

var allShapes = ['circle', 'triangle', 'square', 'diamond', 'rectangle', 'pentagon', 'hexagon', 'octagon'];
var buttonData = [];
var butttonDifferences = {};


function addButton(b, location, color, shape, radius) {
    // Calculate brightness
    red = parseInt(color.substring(1, 3), 16);
    green = parseInt(color.substring(3, 5), 16);
    blue = parseInt(color.substring(5, 7), 16);
    brightness = red + green + blue / 3;

    // Get side count
    var sides;
    if (shape == 'circle') {
        sides = 0;
    } else if (shape == 'triangle') {
        sides = 3;
    } else if (shape == 'pentagon') {
        sides = 5;
    } else if (shape == 'hexagon') {
        sides = 6;
    } else if (shape == 'octagon') {
        sides = 8;
    } else {
        sides = 4;
    }

    var buttonObject = {
        button: b,
        center: location,
        shape: shape,
        sides: sides,
        radius: radius,
        color: color,
        brightness: brightness
    };
   buttonData.push(buttonObject);
}

// Click functions
// append with:  circle.click(clickFunction);
function testClick() {
    console.log("click");
}


//  rhombus, parralellogram, trapezoid <-- do I want these?

// Fancy SVG path things
function makePathString(locations) {
    pathString = 'M';
    pathString = pathString + locations[0].x + ',' + locations[0].y + ',L';
    for (var i = 1; i < locations.length; i++) {
        pathString = pathString + locations[i].x + ',' + locations[i].y
        if (i < locations.length - 1) {
            pathString = pathString + ',';
        }
    }
    pathString = pathString + 'z';
    console.log(pathString);
    return pathString;
}

// via http://blog.furiousbob.com/2011/01/31/having-fun-with-javascript-and-raphael/
// Note that startingAngle is in radians
function makePolyPoints(location, numberSides, radius, startingAngle) {
    locations = []
    for (var i = 0; i < numberSides; i++) {
        var point ={};
        var angle = startingAngle + (i * (1 / numberSides) * 2 * Math.PI);
        point.x = Math.round(location.x + (radius * Math.cos(angle)));
        point.y = Math.round(location.y + (radius * Math.sin(angle)));
        locations.push(point);
    }
    return locations;
}

function makeCircle(paper, location, size) {
    var button = paper.circle(location.x, location.y, size);
    return button;
}

function makeTri(paper, location, size) {
    locations = makePolyPoints(location, 3, size, 0);
    pathString = makePathString(locations);
    var button = paper.path(pathString);
    return button;
}

function makeSquare(paper, location, size) {
    locations = makePolyPoints(location, 4, size, Math.PI / 4);
    pathString = makePathString(locations);
    var button = paper.path(pathString);
    return button;
}

// Rect is a special case:  maybe I'll generalize things up tomorrow
function makeRect(paper, location, size) {
    locations = []
    for (var i = 0; i < 4; i++) {
        var point ={};
        var angle = Math.PI / 4 + (i * (1 / 4) * 2 * Math.PI);
        point.x = Math.round(location.x + (size.x * Math.cos(angle)));
        point.y = Math.round(location.y + (size.y * Math.sin(angle)));
        locations.push(point);
    }

    pathString = makePathString(locations);
    var button = paper.path(pathString);
    return button;
}

function makeDiamond(paper, location, size) {
    locations = makePolyPoints(location, 4, size, 0);
    pathString = makePathString(locations);
    var button = paper.path(pathString);
    return button;
}

function makePenta(paper, location, size) {
    locations = makePolyPoints(location, 5, size, 0);
    pathString = makePathString(locations);
    var button = paper.path(pathString);
    return button;
}

function makeHexa(paper, location, size) {
    locations = makePolyPoints(location, 6, size, 0);
    pathString = makePathString(locations);
    var button = paper.path(pathString);
    return button;
}

function makeOcta(paper, location, size) {
    locations = makePolyPoints(location, 8, size, 0);
    pathString = makePathString(locations);
    var button = paper.path(pathString);
    return button;
}

// Button creation
var buttonFunctions = {circle: makeCircle,
                       square: makeSquare,
                       diamond: makeDiamond,
                       rectangle: makeRect,
                       triangle: makeTri,
                       pentagon: makePenta,
                       hexagon: makeHexa,
                       octagon: makeOcta,
                    };

function makeButton(paper, location, color, shape, radius) {
    var button = buttonFunctions[shape](paper, location, radius)
    addButton(button, location, color, shape, radius);
    button.attr("fill", color);

 }

function makeRandomButton(paper) {
    var location = {x: Math.floor((Math.random() * paper.width)), y: Math.floor((Math.random() * paper.height))};
    var color = '#' + Math.floor(Math.random() * 16777215).toString(16);
    var shapeIndex =  Math.floor(Math.random() * allShapes.length);
    var shape = allShapes[shapeIndex];

    var radius;
    if (shape == 'rectangle') {
        radius = {x: Math.floor(Math.random() * 400) + 1, y: Math.floor(Math.random() * 400) + 1};
    } else {
       radius = Math.floor(Math.random() * 400) + 1; 
    }
    makeButton(paper, location, color, shape, radius);
 }

function init() {
    // Creates canvas.
    var screensize = {x: 1024, y:  768}
    var paper = Raphael(0, 0, screensize.x, screensize.y);
    var numberOfButtons = 1;

    // Let's create a random button
    for (var i = 0; i < numberOfButtons; i++) {
        makeRandomButton(paper);
    }

    // generate differences here


}

window.onload = init;


</script>
</body>
</html>