<!DOCTYPE html>
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<!-- Synth scripts from Stuart Memo:  http://stuartmemo.com/synth/ -->
<script src="synth/tsw.js"></script>
<script src="synth/synth.js"></script>

<script type="text/javascript" src="raphael-min.js"></script>
<script type="text/javascript" src="shapes.js"></script>
<script type="text/javascript" src="buttons.js"></script>
<script type="text/javascript" src="layouts.js"></script>
<script type="text/javascript" src="mod-functions.js"></script>
<script type="text/javascript" src="sort.js"></script>
<script type="text/javascript" src="scales.js"></script>
<script type="text/javascript" src="mappings.js"></script>
</head>

<body>
<script type="text/javascript">

// From http://stackoverflow.com/questions/321113/
function partial(func /*, 0..n args */) {
  var args = Array.prototype.slice.call(arguments, 1);
  return function() {
    var allArguments = args.concat(Array.prototype.slice.call(arguments));
    return func.apply(this, allArguments);
  };
}

// mouse on / off functions:
function betterNoteClick(synth, note) {
    synth.playNote(note);
}

function betterNoteStop(synth, note) {
    synth.stopNote(note);
}

// Global button data
var buttonData = [];
var butttonDifferences = {};
var audioContext;


function init() {
    // Creates canvas.
    var screensize = {x: 1024, y:  768}
    var paper = Raphael(0, 0, screensize.x, screensize.y);
    // create webAudio code
    audioContext = new webkitAudioContext();


    makePiano(paper, {x:50, y:200}, 20, '#AA0000', 'circle', {x:50, y:50}, 0, {}, 1);
    makeZither(paper, {x:145, y:78}, 8, 25, '#909090', 'rectangle',  {x:50, y:20}, 0, {}, 'right');


    // Set of samples
    //makeCircle(paper, {x:400, y:400}, 200, 10, '#AA0000', 'rectangle', {x:10, y:10}, 0, modFunctions);
    //makeLine(paper, {x: 50, y: 150}, 8, 5, 0, '#AA0000', 'circle', {x:25, y:25}, 0, {});
    //makeColumn(paper, {x: 50, y: 100}, 6, 20, '#AA0000', 'circle', {x:50, y:50}, 0, modFunctions);
    //makeRow(paper, {x: 50, y: 100}, 6, 20, '#AA0000', 'circle', {x:50, y:50}, 0, modFunctions);
    //makeRadial(paper, {x:400, y:200}, Math.PI, 5, 5, 55, '#AA0000', 'circle', {x:25, y:25}, 0, {});
    //makeColumnGrid(paper, {x:50, y:50}, 2, 2, {x: 20, y:10}, 0, '#AA0000', 'circle', {x:50, y:50}, 0, {});
    //makeRowGrid(paper, {x:50, y:50}, 3, 5, {x: 20, y:10}, 20, '#AA0000', 'circle', {x:50, y:50}, 0, modFunctions);

    // Create the differences
    generateDifferences();

    // Piano mapping:
    buttonData = orderFromLeft(buttonData);
    mapScaleOrdered(buttonData, 60, 'diatonicMajor');

    // Xylophone mapping:
    //buttonData = orderFromLeft(buttonData);
    //mapScaleOrdered(buttonData, 60, 'diatonicMajor');

    // Small Grid mapping - note that I will need to 
    // talk to my synth a bit to make this work in the main thing.
    // Remember that a lot of these guys need to LOWER the pitch.  
    // I probably also want a 'monophonic / multiphonic' toggle, somewhere in my settings.
    // Which will impact the exact tuning that I return
    // buttonData = orderFromBottomLeft(buttonData);
    // if (buttonData.length == 10) {
    //     mapScaleOrdered(buttonData, 60, 'diatonicBoth');
    // }
    // if (buttonData.length == 9) {
    //     mapScaleOrdered(buttonData, 60, 'diatonicBoth');
    // }
    // if (buttonData.length == 8) {
    //     mapScaleOrdered(buttonData, 60, 'diatonicMajor');
    // }
    // if (buttonData.length == 7) {
    //     mapScaleOrdered(buttonData, 60, 'diatonicMajor');
    // }
    // if (buttonData.length == 7) {
    //     mapScaleOrdered(buttonData, 60, 'diatonicMajor');
    // }
    // if (buttonData.length == 6) {
    //     mapScaleOrdered(buttonData, 60, 'pentatonic');
    // }
    // if (buttonData.length == 5) {
    //     mapScaleOrdered(buttonData, 60, 'pentatonic');
    // }
    // if (buttonData.length == 4) {
    //     mapScaleOrdered(buttonData, 60, 'trumpet');
    // }
    // if (buttonData.length == 3) {
    //     mapScaleOrdered(buttonData, 60, 'trumpet');
    // } 
}

window.onload = init;
</script>
</body>
</html>